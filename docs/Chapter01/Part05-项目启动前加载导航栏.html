<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Part05-项目启动前加载导航栏 | Xblog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/PicGo/logo/favicon.ico">
    <meta name="description" content="Project documentation">
    
    <link rel="preload" href="/PicGo/assets/css/0.styles.badde12b.css" as="style"><link rel="preload" href="/PicGo/assets/js/app.5da9f6f3.js" as="script"><link rel="preload" href="/PicGo/assets/js/2.38e92919.js" as="script"><link rel="preload" href="/PicGo/assets/js/12.b3b58ca0.js" as="script"><link rel="prefetch" href="/PicGo/assets/js/10.07cda984.js"><link rel="prefetch" href="/PicGo/assets/js/11.0a00ac59.js"><link rel="prefetch" href="/PicGo/assets/js/13.9745ae2c.js"><link rel="prefetch" href="/PicGo/assets/js/14.b470fa3d.js"><link rel="prefetch" href="/PicGo/assets/js/15.c0409504.js"><link rel="prefetch" href="/PicGo/assets/js/16.df5ecfc2.js"><link rel="prefetch" href="/PicGo/assets/js/17.0bb6839c.js"><link rel="prefetch" href="/PicGo/assets/js/18.51f7e5c0.js"><link rel="prefetch" href="/PicGo/assets/js/19.3611637a.js"><link rel="prefetch" href="/PicGo/assets/js/20.52081bf9.js"><link rel="prefetch" href="/PicGo/assets/js/21.617e8a9c.js"><link rel="prefetch" href="/PicGo/assets/js/22.0f9e2f2d.js"><link rel="prefetch" href="/PicGo/assets/js/23.7d8482de.js"><link rel="prefetch" href="/PicGo/assets/js/24.33daf0b9.js"><link rel="prefetch" href="/PicGo/assets/js/25.4e7ab2b5.js"><link rel="prefetch" href="/PicGo/assets/js/26.a2e0ad7b.js"><link rel="prefetch" href="/PicGo/assets/js/27.50f2ea4e.js"><link rel="prefetch" href="/PicGo/assets/js/28.52347f74.js"><link rel="prefetch" href="/PicGo/assets/js/3.87e74747.js"><link rel="prefetch" href="/PicGo/assets/js/4.5fc8d47d.js"><link rel="prefetch" href="/PicGo/assets/js/5.f280cf85.js"><link rel="prefetch" href="/PicGo/assets/js/6.c14ca87e.js"><link rel="prefetch" href="/PicGo/assets/js/7.8cba2e22.js"><link rel="prefetch" href="/PicGo/assets/js/8.ec65036e.js"><link rel="prefetch" href="/PicGo/assets/js/9.3da96484.js">
    <link rel="stylesheet" href="/PicGo/assets/css/0.styles.badde12b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/PicGo/" class="home-link router-link-active"><img src="/PicGo/logo/favicon.ico" alt="Xblog" class="logo"> <span class="site-name can-hide">Xblog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/halavah/blog/tree/master/xblog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  项目地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://halavah.github.io/halavah/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/halavah/blog/tree/master/xblog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  项目地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://halavah.github.io/halavah/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于我
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/PicGo/" aria-current="page" class="sidebar-link">快速入手</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Chapter01</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/PicGo/Chapter01/Part01-博客页面划分.html" class="sidebar-link">Part01-博客页面划分</a></li><li><a href="/PicGo/Chapter01/Part02-MyBatis-Plus的使用.html" class="sidebar-link">Part02-MyBatis-Plus的使用</a></li><li><a href="/PicGo/Chapter01/Part03-Controller控制层接口.html" class="sidebar-link">Part03-Controller控制层接口</a></li><li><a href="/PicGo/Chapter01/Part04-自定义Freemaker标签.html" class="sidebar-link">Part04-自定义Freemaker标签</a></li><li><a href="/PicGo/Chapter01/Part05-项目启动前加载导航栏.html" class="active sidebar-link">Part05-项目启动前加载导航栏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PicGo/Chapter01/Part05-项目启动前加载导航栏.html#_5-1-contextstartup-配置类" class="sidebar-link">5.1 ContextStartup 配置类</a></li><li class="sidebar-sub-header"><a href="/PicGo/Chapter01/Part05-项目启动前加载导航栏.html#_5-2-使用" class="sidebar-link">5.2 使用</a></li></ul></li><li><a href="/PicGo/Chapter01/Part06-侧边栏本周热议.html" class="sidebar-link">Part06-侧边栏本周热议</a></li><li><a href="/PicGo/Chapter01/Part07-文章阅读缓存访问量.html" class="sidebar-link">Part07-文章阅读缓存访问量</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Chapter02</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Chapter03</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Chapter04</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="part05-项目启动前加载导航栏"><a href="#part05-项目启动前加载导航栏" class="header-anchor">#</a> Part05-项目启动前加载导航栏</h1> <div class="language-text extra-class"><pre class="language-text"><code>blog
│  pom.xml
│
├─src
│  └─main
│      ├─java
│      │  └─org
│      │      └─myslayers
│      │          ├─config
│      │          │      ContextStartup.java
│      │
│      └─resources
│          ├─templates
│          │  └─inc
│          │        header-panel.ftl
</code></pre></div><h2 id="_5-1-contextstartup-配置类"><a href="#_5-1-contextstartup-配置类" class="header-anchor">#</a> 5.1 ContextStartup 配置类</h2> <ul><li><code>ContextStartup.java</code> ：配置类，【提前加载导航栏中的“提问、分享、讨论、建议”】</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Context配置类
 */</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ContextStartup</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationRunner</span><span class="token punctuation">,</span> <span class="token class-name">ServletContextAware</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">CategoryService</span> categoryService<span class="token punctuation">;</span>

    <span class="token class-name">ServletContext</span> servletContext<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 项目启动时，会同时调用该run方法：提前加载导航栏中的“提问、分享、讨论、建议”，并将其list放入servletContext上下文对象
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ApplicationArguments</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Category</span><span class="token punctuation">&gt;</span></span> categories <span class="token operator">=</span> categoryService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Category</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;categorys&quot;</span><span class="token punctuation">,</span> categories<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * servletContext上下文对象
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setServletContext</span><span class="token punctuation">(</span><span class="token class-name">ServletContext</span> servletContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>servletContext <span class="token operator">=</span> servletContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5-2-使用"><a href="#_5-2-使用" class="header-anchor">#</a> 5.2 使用</h2> <ul><li><code>header-panel.ftl</code> ：模板引擎，【根据 currentCategoryId、categorys 对数据进行渲染】</li></ul> <div class="language-injectedfreemarker extra-class"><pre class="language-text"><code>&lt;#--【二、分类】--&gt;
&lt;div class=&quot;fly-panel fly-column&quot;&gt;
    &lt;div class=&quot;layui-container&quot;&gt;
        &lt;ul class=&quot;layui-clear&quot;&gt;

            &lt;#--首页--&gt;
            &lt;li class=&quot;${(0 == currentCategoryId)?string('layui-hide-xs layui-this', '')}&quot;&gt;&lt;a href=&quot;/&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;
            &lt;#--提问、分享、讨论、建议--&gt;
            &lt;#list categorys as item&gt;
                &lt;li class=&quot;${(item.id == currentCategoryId)?string('layui-hide-xs layui-this', '')}&quot;&gt;&lt;a href=&quot;/category/${item.id}&quot;&gt;${item.name}&lt;/a&gt;&lt;/li&gt;
            &lt;/#list&gt;

            &lt;li class=&quot;layui-hide-xs layui-hide-sm layui-show-md-inline-block&quot;&gt;&lt;span class=&quot;fly-mid&quot;&gt;&lt;/span&gt;&lt;/li&gt;
            &lt;!-- 用户登入后显示 --&gt;
            &lt;li class=&quot;layui-hide-xs layui-hide-sm layui-show-md-inline-block&quot;&gt;&lt;a href=&quot;user/index.html&quot;&gt;我发表的贴&lt;/a&gt;&lt;/li&gt;
            &lt;li class=&quot;layui-hide-xs layui-hide-sm layui-show-md-inline-block&quot;&gt;&lt;a href=&quot;user/index.html#collection&quot;&gt;我收藏的贴&lt;/a&gt;
            &lt;/li&gt;
        &lt;/ul&gt;

        &lt;div class=&quot;fly-column-right layui-hide-xs&quot;&gt;
            &lt;span class=&quot;fly-search&quot;&gt;&lt;i class=&quot;layui-icon&quot;&gt;&lt;/i&gt;&lt;/span&gt;
            &lt;a href=&quot;jie/add.html&quot; class=&quot;layui-btn&quot;&gt;发表新帖&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class=&quot;layui-hide-sm layui-show-xs-block&quot;
             style=&quot;margin-top: -10px; padding-bottom: 10px; text-align: center;&quot;&gt;
            &lt;a href=&quot;jie/add.html&quot; class=&quot;layui-btn&quot;&gt;发表新帖&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/13/2021, 5:23:11 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/PicGo/Chapter01/Part04-自定义Freemaker标签.html" class="prev">
        Part04-自定义Freemaker标签
      </a></span> <span class="next"><a href="/PicGo/Chapter01/Part06-侧边栏本周热议.html">
        Part06-侧边栏本周热议
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/PicGo/assets/js/app.5da9f6f3.js" defer></script><script src="/PicGo/assets/js/2.38e92919.js" defer></script><script src="/PicGo/assets/js/12.b3b58ca0.js" defer></script>
  </body>
</html>
